# Nuclear | hard | forensic 

## Информация
Я попытался перекалибровать навигационную систему корабля (что-то вроде «переустановки Windows»), но теперь требуется заново ввести коды доступа и контрольные ключи. Проблема в том, что я их не помню...

Кажется, старые данные ещё не полностью стерлись из буферов — может, там что-то осталось? Хотелось бы восстановить их в прежнем виде.

Коды доступа я вообще забыл — у меня всегда был автоматический вход в систему. А вот контрольные ключи... вроде бы я их задавал, но никогда не использовал. Хотя точно помню, там был вопрос про первую космическую академию...

Может, поищем в логах или резервных хранилищах? Или проверим, не осталось ли следов в поврежденных данных? Это же HyperOzon — у нас должны быть способы восстановить доступ!

https://disk.yandex.ru/d/Z6pzTDrDN5776A

## Решение

Флаг был разделен на две части - одна лежала в сохраненном для входа пароле, а вторая - в ответе на контрольный вопрос. 

На самом деле, оба этих значения хранятся в Windows открыто, и их можно получить, исследуя кусты реестра. 

Так как дамп памяти был снят с установщика, к которому была примонтирована старая система, стандартные методы работы с реестром были недоступны, и надо было вручную исследовать нужные (и не перепутать их с кустами из системы установщика) файлы кустов. 

Так, сохраненный пароль можно было достать из куста SOFTWARE по пути `Microsoft\Windows NT\CurrentVersion\Winlogon`. Для просмотра файлов кустов реестра можно было использовать программы типа Registry Viewer.

Ответы на контрольные вопросы же хранятся в кусте SAM, и для их просмотра можно было либо воспользоваться утилитой SecurityQuestionsView, либо просто прогнать файл хайва утилитой strings.

## Постмортем
По не известным нам причинам, первая часть флага, находившаяся в сохраненном для автовхода пароле, куда-то пропала (хотя таск тестировался). 
Однако, к моменту, как мы это заметили, ни один из участников еще не достал вторую часть флага - из контрольных вопросов. Поэтому мы решили отдать первую часть флага вместе с хинтом на вторую. 

## флаг
`ozonctf{wow_its_pass_created_in_1905}`
